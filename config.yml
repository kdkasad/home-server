---
####################
# General settings #
####################

general:
  # Set the hostname of the server
  hostname: casad

  # Web domain name of the server
  domain: box.kasad.com

  # Set the timezone
  timezone: America/Los_Angeles

  # Only automatically install security updates
  auto_update_packages: security

users:
  worker: worker
  nas: nas

####################
# Storage settings #
####################

storage:

  # Directory in which application data will be stored
  data_dir: /data

  # Directory in which NAS will be mounted
  nas_dir: /nas

  # Directory for Docker images
  docker_dir: /var/lib/docker

  # Define LVM volumes
  vg: pool
  volumes:
    root:
      mount: /
      size: 64G
      fs: ext4

    nas:
      mount: /nas
      size: 50G
      fs: ext4

    data:
      mount: /data
      size: 100G
      fs: ext4

#################
# Samba options #
#################

# See https://github.com/vladgh/ansible-collection-vladgh-samba
samba_guest_account: "{{ users.nas }}"
samba_shares_root: "{{ storage.nas_dir }}"
samba_manage_directories: no
samba_netbios_name: "{{ general.hostname }}"
samba_server_string: Home NAS
samba_wins_support: no
samba_domain_master: no
samba_preferred_master: no
samba_local_master: yes

# Treat unknown users as guests, but treat bad passwords as errors.
# See https://www.samba.org/samba/docs/current/man-html/smb.conf.5.html
samba_map_to_guest: Bad User

samba_shares:
  - name: Dump
    comment: A place for files to go
    public: yes
    writeable: yes

############################
# Minecraft server options #
############################

minecraft_server_enabled: yes
minecraft_server_env:
  # Server properties
  SERVER_PORT: "25565"
  ENFORCE_SECURE_PROFILE: "false"
  ONLINE_MODE: "false"
  ENABLE_COMMAND_BLOCK: "true"
  ENABLE_QUERY: "true"

  # Enable automatically pausing when nobody is online
  EXEC_DIRECTLY: "false"
  ENABLE_AUTOPAUSE: "true"
  MAX_TICK_TIME: "-1" # See https://docker-minecraft-server.readthedocs.io/en/latest/misc/autopause-autostop/autopause/
  AUTOPAUSE_TIMEOUT_EST: "600" # Pause 10 minutes after last player disconnects
  AUTOPAUSE_TIMEOUT_INIT: "60" # Pause 1 minute after startup if inactive

  # Server settings
  TYPE: fabric
  VERSION: "1.20.4"
  INIT_MEMORY: "512M"
  MAX_MEMORY: "4G"

  # For custom datapacks and resource packs from vanillatweaks.net
  # https://vanillatweaks.net/share#<sharecode>
  VANILLATWEAKS_SHARECODE: rIS4z6,IWrn6G # data, resource

  # Mods to download from Modrinth
  # https://modrinth.com/mods/<slug>
  MODRINTH_PROJECTS: |-
    fabric-api
    lithium
    no-chat-reports
    fabrictailor
    coord-finder:beta
    carpet

######################
# Authentik settings #
######################

authentik_enabled: yes

# Traefik routing options for Authentik
authentik_routing:
  enabled: true
  subdomain: auth

authentik_env:
  # These first three don't need to be encrypted. It's just so scrapers don't
  # pick up my email and try to spam me or find the password.
  AUTHENTIK_EMAIL__FROM: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          65396332633535623564303664363664323466386462363966646562626330613438386331613663
          6638333366346436363961363435346136333035633466320a396634363365343565346636396230
          63636637356562613735326637353963396561616666633065303139376230333833376533653039
          6430326166323835620a643435643064386630373936353234626536353334646533353739343264
          66363161386262643334313236376332633133393264306130373733386463333562353364646435
          6330643665636363323862346531636239396164316363393364
  AUTHENTIK_EMAIL__HOST: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          64643964303538646335363338356162353331303035373731396137346633643961323066326332
          6533343831346563353963343163646663356663656235650a643563303639343962616534633639
          61646264656164346335626339376431633432646635366261653539653234343134313932373663
          6464393730643633320a353630626161636262363238326633663532373236626266663534656531
          3237
  AUTHENTIK_EMAIL__USERNAME: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          35336235353037343636393434613936396633633031303939646465393237386537613036393631
          6537626663393030313739333032363433646637323637300a633263663864613932333030303663
          61303132316132653134653530343732373061336130336666373130656533346464346138646230
          3831306434613666340a383961653463653161633235383266646162396162323865633937306635
          6165

  AUTHENTIK_EMAIL__PORT: 465
  AUTHENTIK_EMAIL__USE_SSL: true
  AUTHENTIK_EMAIL__TIMEOUT: 10

  # These two are actually sensitive and must be encrypted
  AUTHENTIK_EMAIL__PASSWORD: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          63373331356430383761666262633163626666636266366663316665373766353432356133626639
          6238336535363465333930643464646230383530643837320a386234353332316665333461656465
          61656336613537323666313536346531373864646132636664343062666534316264626138333138
          3539373230376439300a396436613238343832636230336664656264643334396136383133353330
          31623366333032613834626135646431346430336537353038376266353133346332363035633566
          66363034333832626465323263643965383964333232303339386461643835363366323663343364
          353164663837333564323234333361666431
  PG_PASS: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          30643135386566643563353636363461363538653139336235343830383835643637363133303234
          3533373439376463353262316534376632363366613437380a366365363961363631373338643339
          31303266323430323139323736366564636537363735393863626161343262393734353831623861
          6464643634313137330a363030653661653534346566323136663565636633356231623666383265
          33363933613666343264623332366264306634666264363265376135616363316139323930663566
          39323166633333386261666233353631383130313337616162383536346666303835393664333236
          616335616636626132386664303330373238

####################
# Traefik settings #
####################

traefik_enabled: true

traefik_ports:
    http: 80
    https: 443

# See https://doc.traefik.io/traefik/https/acme/ for information on how to
# configure the provider and environment variables.
traefik_acme_dns:
  enabled: true
  provider: cloudflare

  # The email doesn't need to be encrypted, but doing so hides it from bots
  # scraping GitHub for credentials.
  email: !vault |
    $ANSIBLE_VAULT;1.1;AES256
    37613330376338623961356535306261343666353230336332616334353731356537633537363365
    6538643266623632376266346363363334363135373134330a626331363833633166313830306566
    34626236333964306433356562333535326462396635303265343731313535636265363934333431
    6430346165366230340a333462303031663431303037393231356262396264383737643564623566
    35346663663934353337376338623863303462643236373033386332616162346363

  # This is sensitive and must be encrypted.
  env:
    CF_DNS_API_TOKEN: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      31643036333238623863656134613562623965323864333633366130613332653239363433626564
      3463303235323230663563393631373337643763613335380a666561666438383435616237633532
      64313130363866616234313838633736653535666561656463346132306435663264396231346630
      6631346635363461660a326334313937316631383239663539346565616261333737383764376438
      38356136626534383064613934333435316234656436313732646137373834343565316531346163
      3930353265343938343332386563643063306139653662306330
